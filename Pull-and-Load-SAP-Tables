Option Compare Database



Option Explicit
Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems
Dim SapGuiAuto As Variant
Dim SapApp As Variant
Dim Connection As Variant
Dim Session As Variant
Dim wscript As Variant

Sub ConnectSAP()


On Error GoTo errmsg
   '   SETS SAP OBJECTS
    If Not IsObject(SapApp) Then
       Set SapGuiAuto = GetObject("SAPGUI")
       Set SapApp = SapGuiAuto.GetScriptingEngine
    End If
    If Not IsObject(Connection) Then
       Set Connection = SapApp.Children(0)
    End If
    If Not IsObject(Session) Then
       Set Session = Connection.Children(0)
    End If
    If IsObject(wscript) Then
       wscript.ConnectObject Session, "on"
       wscript.ConnectObject Application, "on"
    End If
    
'clear the tcode in SAP
Session.findById("wnd[0]").resizeWorkingPane 222, 29, False
Session.findById("wnd[0]/tbar[0]/okcd").Text = "/n"
Session.findById("wnd[0]").sendVKey 0
       
Exit Sub
errmsg:
MsgBox ("Open and login to SAP first")
End
End Sub

Public Sub VBAP_SAP_Download()
Call ConnectSAP


Dim MyXL As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim mydate As String
Dim GIStart As String
Dim GIEnd As String
Dim myFileName As String

DoCmd.OpenForm "MAIN MENU"

temp = Format(Now(), "mm-dd-yy")
TempFileName = "VBAP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
GIStart = Forms![MAIN MENU]![GI_Date_Start].Value
GIEnd = Forms![MAIN MENU]![GI_Date_End].Value
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

'Enter in the table name
Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "VBAP"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Sales Document
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Item
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "POSNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Material
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MATNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Description
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ARKTX"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Prod Heirarchy
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "PRODH"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Refernece Doc for delievery link
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VGBEL"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Plant
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "WERK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Original RRD
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZEDATU"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Ori Mat Avaible date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZMBDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Orig GI date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZWADAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Revised RRD
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZEDATU_R"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Revised Mat date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZMBDAT_R"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Revised GI date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZWADAT_R"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        GI day
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZGIDAY"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Net Value
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "NETWR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Doc-Currency
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "WAERK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Order-Qty
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KWMENG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Sales Unit
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VRKME"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Define the search critierias
'Use Finder to select the fields        Select Sale Doc from Spreadsheet
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "zzwadat_r"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 9
Session.findById("wnd[1]").sendVKey 0
'Enter date range
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,0]").Text = GIStart
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-HIGH[3,0]").Text = GIEnd
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-HIGH[3,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-HIGH[3,0]").caretPosition = 10
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press

Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'With New Excel.Application
'Allow for exter time to haev excel open
Sleep (4000)

On Error Resume Next ' Defer error trapping.

    Set MyXL = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXL = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXL.Application.Visible = True
    MyXL.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXL.Application.Quit
    End If
    
    'MyXL.Save
    'MyXL.Close

    'ActiveWorkbook.Close
    'Workbooks.Close
    

    Set MyXL = Nothing    ' Release reference to the
                                ' application and spreadsheet

temp = ""
TempFileName = ""
mydate = ""
GIStart = ""
GIEnd = ""
myFileName = ""
MyXL = ""

Err.Clear

'MsgBox "LineFill Report's VBAP Sales Document Items COMPLETE!"


End Sub



Public Sub VBAP_Loader()

Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delVBAP As String
Dim mydate As String


temp = Format(Now(), "mm-dd-yy")
TempFileName = "VBAP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    'xlApp.Visible = True
    xlApp.Visible = False
    
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delVBAP = "DELETE * From [tbl-VBAP]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delVBAP
    DoCmd.SetWarnings True
    
     DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-VBAP", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing

End Sub


Sub VBAK_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_SalesDoc_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True


Dim MyXLVBAK As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String


temp = Format(Now(), "mm-dd-yy")
TempFileName = "VBAK-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "VBAK"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Sales Document
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Created on
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ERDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Document Cat
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBTYP"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Sales Doc Type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "AUART"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Delivery lock
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LIFSK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Billing Block
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "FAKSK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    request deleivery date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VDATU"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Mat vaible date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "FMBDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Delivery Block Ind
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZDEL_IND"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Credit Block
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZCRED_IND"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Incomplet order ind
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ZZINC_ORD_IND"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

'Load the Ssaled doc into clipboard and past them into VBLEN
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press

'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press

Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)


On Error Resume Next ' Defer error trapping.

    Set MyXLVBAK = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLVBAK = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLVBAK.Application.Visible = True
    MyXLVBAK.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLVBAK.Application.Quit
    End If
    
    'MyXLVBAK.Save
    'MyXLVBAK.Close
   'ActiveWorkbook.Close

    Set MyXLVBAK = Nothing    ' Release reference to the
                                ' application and spreadsheet

TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLVBAK = ""
Err.Clear


'MsgBox "LineFill Report's VBAK Sales Document Header COMPLETE!"


End Sub


Public Sub VBAK_Loader()

Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delVBAK As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "VBAK-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delVBAK = "DELETE * From [tbl-VBAK]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delVBAK
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-VBAK", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing

End Sub



Public Sub LIPS_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_SalesDoc_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True


Dim MyXLLIPS As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "LIPS-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "LIPS"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Sales Deleivery document
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Item
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "POSNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Created on
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ERDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Material
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MATNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Plant
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "WERKS"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Store location
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LGORT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Product H
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "PRODH"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Delivery QTY
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LFIMG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Base UOM
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MEINS"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Sales Unit
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VRKME"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Block
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "FAKSP"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

'Use Finder to select the fields       Material Avi Date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MBDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    QTY Stock unit
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LGMNG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

'Use Finder to select the fields        refernece Doc
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VGBEL"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Ref Item
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VGPOS"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Movement type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "BWART"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Avaible Check
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MTVFP"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Delivery Group
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "GRKOR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Load the Ssaled doc into clipboard and past them into
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VGBEL"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press

Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)


On Error Resume Next ' Defer error trapping.

    Set MyXLLIPS = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLLIPS = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLLIPS.Application.Visible = True
    MyXLLIPS.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLLIPS.Application.Quit
    End If
    
    'MyXLLIPS.Save
    'MyXLLIPS.Close
    'ActiveWorkbook.Close

    Set MyXLLIPS = Nothing    ' Release reference to the
                                ' application and spreadsheet


TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLLIPS = ""
Err.Clear

'MsgBox "LineFill Report's LIPS Sales Document Delivery Item COMPLETE!"

End Sub



Public Sub LIPS_Loader()

Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delLIPS As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "LIPS-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delLIPS = "DELETE * From [tbl-LIPS]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delLIPS
    DoCmd.SetWarnings True
    
    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-LIPS", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    
    xlApp.Quit
    Set xlApp = Nothing

End Sub


Public Sub LIKP_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_Delivery_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True


Dim MyXLLIKP As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String



temp = Format(Now(), "mm-dd-yy")
TempFileName = "LIKP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "LIKP"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Sales Deleivery document
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Sales Org
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VKORG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Delivery type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LFART"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Complete Dlv
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "AUTLF"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Order Combind
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KZAZU"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Planned Good Movement
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "WADAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Load date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LDDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Transpl Plang Date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TDDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Delivery date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LFDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Pick date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KODAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Route
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ROUTE"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields      Billing Block
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "FAKSK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Delivery Block
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LIFSK"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields       Delivery Proir
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LPRIO"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Ship to party
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KUNNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Sold to party
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KUNAG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields   Billing Date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "FKDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Route 2
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ROUTA"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Sales Org
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VKOIV"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Actual GI Date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "WADAT_IST"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Load the Ssaled doc into clipboard and past them into VBLEN
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press

Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)


On Error Resume Next ' Defer error trapping.

    Set MyXLLIKP = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLLIKP = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLLIKP.Application.Visible = True
    MyXLLIKP.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLLIKP.Application.Quit
    End If
    
    'MyXLLIKP.Save
    'MyXLLIKP.Close
    'ActiveWorkbook.Close

    Set MyXLLIKP = Nothing    ' Release reference to the
                                ' application and spreadsheet


TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLLIKP = ""
Err.Clear


'MsgBox "LineFill Report's LIKP Sales Document Delivery Header Item COMPLETE!"



End Sub


Public Sub LIKP_Loader()

Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delLIKP As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "LIKP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delLIKP = "DELETE * From [tbl-LIKP]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delLIKP
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-LIKP", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing

End Sub


Public Sub VTTP_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_Delivery_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True

Dim MyXLVTTP As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "VTTP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "VTTP"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Shipment Doc
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TKNUM"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Item
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TPNUM"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Deleivery
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Itineray
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TPRFO"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Shipment Created on date
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ERDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Load the Ssaled doc into clipboard and past them into VBLEN
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "VBELN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press


Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)


On Error Resume Next ' Defer error trapping.

    Set MyXLVTTP = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLVTTP = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLVTTP.Application.Visible = True
    MyXLVTTP.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLVTTP.Application.Quit
    End If
    
    'MyXLVTTP.Save
    'MyXLVTTP.Close
    'ActiveWorkbook.Close

    Set MyXLVTTP = Nothing    ' Release reference to the
                                ' application and spreadsheet

TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLVTTP = ""
Err.Clear


'MsgBox "LineFill Report's LIKP Sales Document Delivery Header Item COMPLETE!"



End Sub

Public Sub VTTP_Loader()
'Shipment Item Table
Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delVTTP As String
Dim mydate As String



temp = Format(Now(), "mm-dd-yy")
TempFileName = "VTTP-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, True, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delVTTP = "DELETE * From [tbl-VTTP]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delVTTP
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-VTTP", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True


    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing

End Sub

Public Sub VTTK_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_Ship_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True

Dim MyXLVTTK As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "VTTK-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName



Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "VTTK"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press

'Use Finder to select the fields    Shipment Number
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TKNUM"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Shipment type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "SHTYP"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Created on
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ERDAT"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    ShipmentComTpye
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ABFER"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Container ID
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "SIGNI"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Seal number
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "EXTI1"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    ActLoadEndTimne
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "UALEN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Shipment Comple
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "STABF"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Shipment Start
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "STTBG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Acc Tran Strt Tm
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "UATBG"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Act Shipment End
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "DATEN"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Shipment Order
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TERNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Load the Ssaled doc into clipboard and past them into VBLEN
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "TKNUM"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press

Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)


On Error Resume Next ' Defer error trapping.

    Set MyXLVTTK = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLVTTK = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLVTTK.Application.Visible = True
    MyXLVTTK.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLVTTK.Application.Quit
    End If
    
    'MyXLVTTK.Save
    'MyXLVTTK.Close
    'ActiveWorkbook.Close

    Set MyXLVTTK = Nothing    ' Release reference to the
                                ' application and spreadsheet

TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLVTTK = ""
Err.Clear


'MsgBox "LineFill Report's VTTK Sales Document Delivery Header Item COMPLETE!"



End Sub

Public Sub VTTK_Loader()
'shipment Heder table
Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delVTTK As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "VTTK-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delVTTK = "DELETE * From [tbl-VTTK]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delVTTK
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-VTTK", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    
    
    xlApp.Quit
    Set xlApp = Nothing

End Sub


Public Sub KNA1_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_Customer_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True

Dim MyXLKNA As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String


temp = Format(Now(), "mm-dd-yy")
TempFileName = "KNA1-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "KNA1"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press

'Use Finder to select the fields    Shipment Number
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KUNNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Shipment type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LAND1"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Created on
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "NAME1"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    ShipmentComTpye
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "ORT01"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Container ID
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "PSTLZ"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Seal number
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "REGIO"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Load the Ssaled doc into clipboard and past them into VBLEN
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "KUNNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press
'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press


Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)

On Error Resume Next ' Defer error trapping.

    Set MyXLKNA = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLKNA = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLKNA.Application.Visible = True
    MyXLKNA.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLKNA.Application.Quit
    End If
    
    'MyXLKNA.Save
    'MyXLKNA.Close
    'ActiveWorkbook.Close

    Set MyXLKNA = Nothing    ' Release reference to the
                                ' application and spreadsheet

TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLKNA = ""
Err.Clear

'MsgBox "LineFill Report's KNA1 Sales Document Delivery Header Item COMPLETE!"



End Sub


Public Sub KNA1_Loader()
'shipment Heder table
Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delKNA1 As String
Dim mydate As String


temp = Format(Now(), "mm-dd-yy")
TempFileName = "KNA1-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE
    
  
    delKNA1 = "DELETE * From [tbl-KNA1]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delKNA1
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-KNA1", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing

'Call CloseAllExcel


End Sub

Sub MARA_SAP_Download()

Call ConnectSAP

DoCmd.OpenQuery "qry_Material_Run_List"
DoCmd.RunCommand acCmdSelectAllRecords
DoCmd.RunCommand acCmdCopy
DoCmd.SetWarnings False
DoCmd.Close
DoCmd.SetWarnings True

Dim MyXLMARA As Object    ' Variable to hold reference                              ' to Microsoft Excel.
Dim ExcelWasNotRunning As Boolean    ' Flag for final release.
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim mydate As String


temp = Format(Now(), "mm-dd-yy")
TempFileName = "MARA-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName

Session.findById("wnd[0]").Maximize

If Session.Info.Transaction <> "ZSE16N" Then
    'Temp measure, have it navgiate for the future
    Session.sendcommand ("/nZSE16N")
End If

Session.findById("wnd[0]/usr/ctxtGD-TAB").Text = "MARA"
Session.findById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
Session.findById("wnd[0]").sendVKey 0
Session.findById("wnd[0]/tbar[1]/btn[18]").press
'Use Finder to select the fields    Material
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MATNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]").sendVKey 0
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Material Type
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MTART"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Lab Office
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "LABOR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Product Hierachy
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "PRHDA"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Batch Managed
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "XCHPF"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        X-Plant Status
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MSTAE"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    X-DChain Staus
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MSTAV"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields    Rem. Shelf Life
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MHDRZ"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Tot. shelf life
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MHDHB"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True
'Use Finder to select the fields        Material description
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MAKTX"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/chkGS_SELFIELDS-MARK[5,0]").Selected = True

'Load the Ssaled doc into clipboard and past them into Material
Session.findById("wnd[0]/tbar[0]/btn[71]").press
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").Text = "MATNR"
Session.findById("wnd[1]/usr/sub:SAPLSPO4:0300/txtSVALD-VALUE[0,21]").caretPosition = 5
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'load the Sales doc from memory for searching
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").SetFocus
Session.findById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/btnPUSH[4,0]").press
Session.findById("wnd[1]/tbar[0]/btn[24]").press
Session.findById("wnd[1]/tbar[0]/btn[8]").press
Session.findById("wnd[0]/tbar[1]/btn[8]").press

'save excel file and close
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").pressToolbarContextButton "&MB_EXPORT"
Session.findById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").selectContextMenuItem "&XXL"
'long wait for SAP to Selct large range
Session.findById("wnd[1]/tbar[0]/btn[0]").press
'Sleep (2000)
'Need to have a folder named
Session.findById("wnd[1]/usr/ctxtDY_PATH").Text = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\"
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").Text = TempFileName
Session.findById("wnd[1]/usr/ctxtDY_FILENAME").caretPosition = 1
Session.findById("wnd[1]/tbar[0]/btn[0]").press


Sleep (1000)

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Allow for exter time to haev excel open
Sleep (4000)

On Error Resume Next ' Defer error trapping.

    Set MyXLMARA = GetObject(, "Excel.Application")
    If Err.Number <> 0 Then ExcelWasNotRunning = True
    
    
    Err.Clear    ' Clear Err object in case error occurred.
' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel
    
' Set the object variable to reference the file you want to see.
    Set MyXLMARA = GetObject(myFileName)
    
    
' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXLMARA.Application.Visible = True
    MyXLMARA.Parent.Windows(1).Visible = True
    
    
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXLMARA.Application.Quit
    End If
    
    'MyXLMARA.Save
    'MyXLMARA.Close
    'ActiveWorkbook.Close

    Set MyXLMARA = Nothing    ' Release reference to the
                                ' application and spreadsheet


TempFileName = ""
temp = ""
myFileName = ""
mydate = ""
MyXLMARA = ""
Err.Clear

'MsgBox "LineFill Report's MARA Sales Document Header COMPLETE!"


End Sub


Public Sub MARA_Loader()

Dim xlApp As Object
Dim wb As Workbook
Dim ws As Worksheet
Dim temp As String
Dim TempFileName As String
Dim myFileName As String
Dim delMARA As String
Dim mydate As String

temp = Format(Now(), "mm-dd-yy")
TempFileName = "MARA-" & temp & ".XLSX"
mydate = Trim(VBA.Format(Now(), "MM-DD-YY"))
myFileName = "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName


    Set xlApp = CreateObject("Excel.Application")
   ' xlApp.Application.ScreenUpdating = False
    xlApp.Visible = False
    
    Set wb = xlApp.Workbooks.Open(myFileName, 2, False)
    Set ws = wb.Worksheets("Sheet1") 'EDIT TO ACTUAL SHEET NAME HERE

    delMARA = "DELETE * From [tbl-MARA]"

    DoCmd.SetWarnings False
    DoCmd.RunSQL delMARA
    DoCmd.SetWarnings True

    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, "tbl-MARA", "C:\Users\10113599\Desktop\LineFill-" & mydate & "\" & TempFileName, True

    wb.Save
    wb.Close False
    xlApp.Quit
    Set xlApp = Nothing
    
    MsgBox "LineFill Report's HAS COMPLETED LOADING ALL THE TABLES!!!! COMPLETE!"

End Sub





